<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>InterviewPrep Hackathon</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="src/style.css">
  <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="src/main.js" type="module"></script>
  <script src="src/elevenlabs.js"></script>
  <script src="./src/webkitRecognition.js"></script>
</head>

<body style="overflow: hidden;"></body>
<script>
  let technical_prompt = `You are Alex, a seasoned software engineer conducting the technical interview for the role of Junior Software Engineer. Your goal is to assess the candidate's technical proficiency, problem-solving abilities, and understanding of core programming concepts. Tailor your questions to gauge the candidate's ability to apply their knowledge to practical scenarios and explain their thought process clearly. Ensure the questions are structured progressively, starting with fundamentals and gradually increasing in complexity.
  
  Focus areas for the questions should include:
  
  Programming concepts (data structures, algorithms, OOP).
  Problem-solving and debugging.
  Familiarity with tools, frameworks, or languages mentioned in the job description.
  Code optimization and best practices.
  Their approach to version control (e.g., Git).
  Ask 8–10 questions, ensuring a mix of conceptual and scenario-based challenges. Encourage the candidate to talk through their thought process for each answer. Provide them with code snippets or short problems as needed for a practical evaluation. Your response should be less than 10 words, setting a professional and collaborative tone. Avoid unnecessary formalities or non-technical discussions. First you'll introduce yourself and make the candidate comfortable.
  
  Example:
  User: Hello!
  You: Hello, welcome! I’m Alex, your technical interviewer today. Let’s dive into some coding and problem-solving!`
  let hr_prompt = `You are Steve, a professional interviewer who is evaluating HR part for the job of Junior Software Engineer. He has done his technical round already. Your job is to ask thoughtful and relevant questions to the interviewer that demonstrate the candidate's curiosity, interest in the company, and alignment with its culture. Ensure the questions are polite, engaging, and reflective of the candidate's desire to understand the company's environment, values, and growth opportunities. Avoid overly technical or role-specific questions in this context. Ask 8-10 questions, covering topics like:- Company culture and work environment- Opportunities for professional growth- Team dynamics and communication- Leadership style and expectations- Work-life balance and flexibility Make sure the questions are concise, open-ended, and conversational. Don't offer any tea coffee or anything. Your introductory speech should be around 15 words.
  
  For example:
  user: Hello!
  You: Hello! welcome, and thank you for taking the time to meet with us today. I hope you're doing well. My name is Steve, and I’m part of the HR team here. It's great to have you here.`
</script>
<script src="./src/llmResponse.js"></script>
<script>
  let changeMorphTargetByName
  let camera, scene, renderer, avatar, light
  let client = io()
  let isListening = false;
  let firstTime = true;
  let response = ""
  let micIndicator;
  let insideVR = false;
  let conversation_count = 0


  function handleButtonClick() {
    let user_text = document.getElementById('user-text');
    let button = document.querySelector('button');

    if (isListening) {
      user_text.innerHTML = '';
      button.innerHTML = 'Speak';
      button.classList.remove('listening');
      stopMicrophone();
    } else {
      user_text.innerHTML = 'Listening...';
      button.innerHTML = 'Stop';
      button.classList.add('listening');
      elevenLabsSocket = new WebSocket(wsUrl);
      startMicrophone();
    }

    isListening = !isListening;
  }
  function handleStart() {
    document.getElementById("start-button").style.display = 'none';
    document.getElementById("toggle-button").style.display = 'none';
    document.getElementById("end-button").style.display = 'inline-block';
    initSpeech();
  }
  
  function handleEnd() {
    document.getElementById("end-button").style.display = 'none';
    document.getElementById("speak-button").style.display = 'none'
    
    // fetch result
  }
  
  async function initSpeech() {
    response = await getResponse(`Hello!`);
    getAudioAndCharsFromElevenLabs(response)
  }
  // Function to update microphone indicator color

  document.addEventListener('keydown', (event) => {
    if (event.key === 's') {
      handleStart();
    } else if (event.key === 'm') {
      handleButtonClick();
    }
  });

  function handleToggle() {
    const toggleButton = document.getElementById("toggle-button");

    if (toggleButton.classList.contains('technical')) {
      toggleButton.classList.remove('technical');
      toggleButton.classList.add('hr');
      toggleButton.innerHTML = "HR";
      updateSystemPrompt(hr_prompt)
    } else {
      toggleButton.classList.remove('hr');
      toggleButton.classList.add('technical');
      toggleButton.innerHTML = "Technical";
      updateSystemPrompt(technical_prompt)
    }
  }
</script>
<div class="overlay">
  <button class="speak-button hr" id="toggle-button"
    onclick="handleToggle()">HR</button>
  <button class="speak-button" id="speak-button" style="display: none;" onclick="handleButtonClick()">Speak</button>
  <button class="speak-button" id="start-button" onclick="handleStart()">Start</button>
  <button class="speak-button" style="display: none; background-color: #f44336;" id="end-button"
    onclick="handleEnd()">End</button>
</div>
<div class="conversation-user hidden" id="user-div">
  <p class="capitalize" id="user-text"></p>
</div>
<div class="conversation-avatar hidden" id="interviewer-div">
  <p class="capitalize" id="interviewer-text"></p>
</div>
<audio id="audioPlayback" hidden controls>
  <source id="audioSource" type="audio/mp3" src="" />
</audio>
</body>

</html>